---
// src/pages/forms/hotel/[productId].astro
import Layout from "@/layouts/Layout.astro"
import SignInPage from "@/pages/SignInPage.astro"
import { db, eq, Product } from "astro:db"
import { getSession } from "auth-astro/server"

const { productId } = Astro.params
const session = await getSession(Astro.request)

let productBase
if (productId) {
	productBase = await db.select().from(Product).where(eq(Product.id, productId)).get()
}
---

<Layout title="Crear Detalles de Hotel">
	{
		session ? (
			<article class="mx-auto w-10/12 rounded-lg bg-beaver-900 p-8 text-gray-300 sm:p-10 md:max-w-lg lg:max-w-2xl lg:p-20">
				<h2 class="mb-4 text-2xl font-semibold">DETALLES DEL HOTEL</h2>
				<p class="mb-6 text-xs text-gray-400">Añade la información específica de tu hotel.</p>
				{productBase && (
					<p class="mb-4 text-sm">
						Producto: <span class="font-bold">{productBase.name}</span>
					</p>
				)}

				<form id="hotelForm" method="post" class="flex flex-col gap-4" data-form-type="hotel">
					<input type="hidden" name="productId" value={productId} />

					<label for="stars" class="block text-xs font-medium text-gray-400 md:text-sm">
						Categoría (estrellas)
						<input
							type="number"
							id="stars"
							name="stars"
							placeholder="Ej: 3, 4, 5"
							min="1"
							max="5"
							class="mt-1 block w-full rounded-md border border-gray-600 bg-gray-700 px-3 py-2 text-white shadow-sm focus:border-green-150 focus:outline-none focus:ring-green-150 sm:text-sm"
							required
						/>
					</label>

					<label for="address" class="block text-xs font-medium text-gray-400 md:text-sm">
						Dirección del Hotel
						<input
							type="text"
							id="address"
							name="address"
							placeholder="Ej: Av. 6 de Agosto #123"
							class="mt-1 block w-full rounded-md border border-gray-600 bg-gray-700 px-3 py-2 text-white shadow-sm focus:border-green-150 focus:outline-none focus:ring-green-150 sm:text-sm"
							required
						/>
					</label>

					<label for="phone" class="block text-xs font-medium text-gray-400 md:text-sm">
						Teléfono de Contacto
						<input
							type="tel"
							id="phone"
							name="phone"
							placeholder="Ej: +591 71234567"
							class="mt-1 block w-full rounded-md border border-gray-600 bg-gray-700 px-3 py-2 text-white shadow-sm focus:border-green-150 focus:outline-none focus:ring-green-150 sm:text-sm"
						/>
					</label>

					<label for="email" class="block text-xs font-medium text-gray-400 md:text-sm">
						Email de Contacto
						<input
							type="email"
							id="email"
							name="email"
							placeholder="Ej: info@hotel.com"
							class="mt-1 block w-full rounded-md border border-gray-600 bg-gray-700 px-3 py-2 text-white shadow-sm focus:border-green-150 focus:outline-none focus:ring-green-150 sm:text-sm"
						/>
					</label>

					<label for="website" class="block text-xs font-medium text-gray-400 md:text-sm">
						Sitio Web (URL)
						<input
							type="url"
							id="website"
							name="website"
							placeholder="Ej: https://www.hotel.com"
							class="mt-1 block w-full rounded-md border border-gray-600 bg-gray-700 px-3 py-2 text-white shadow-sm focus:border-green-150 focus:outline-none focus:ring-green-150 sm:text-sm"
						/>
					</label>

					<label for="checkInTime" class="block text-xs font-medium text-gray-400 md:text-sm">
						Hora de Check-in (formato HH:MM)
						<input
							type="time"
							id="checkInTime"
							name="checkInTime"
							class="mt-1 block w-full rounded-md border border-gray-600 bg-gray-700 px-3 py-2 text-white shadow-sm focus:border-green-150 focus:outline-none focus:ring-green-150 sm:text-sm"
							required
						/>
					</label>

					<label for="checkOutTime" class="block text-xs font-medium text-gray-400 md:text-sm">
						Hora de Check-out (formato HH:MM)
						<input
							type="time"
							id="checkOutTime"
							name="checkOutTime"
							class="mt-1 block w-full rounded-md border border-gray-600 bg-gray-700 px-3 py-2 text-white shadow-sm focus:border-green-150 focus:outline-none focus:ring-green-150 sm:text-sm"
							required
						/>
					</label>

					<div class="mt-10 flex justify-end">
						<button
							type="submit"
							class="h-10 w-40 rounded-lg bg-white p-1 text-black hover:bg-green-150 hover:text-lg"
						>
							Guardar Hotel
						</button>
					</div>
				</form>
			</article>
		) : (
			<div class="flex items-center justify-center">
				<SignInPage />
			</div>
		)
	}
</Layout>

<script src="/src/lib/utils/formHandler"></script>
